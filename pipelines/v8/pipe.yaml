# preprocessing
- name: fiducial_tfrecords
  cmd: esub msfm/apps/run_fiducial_preprocessing.py \
    --n_files=1000 \
    --config=configs/v8/linear_bias.yaml \
    --dir_in=/home/ipa/refreg/data/data_products/CosmoGrid/processed/CosmoGrid/v11desy3 \
    --dir_out=/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v8/linear_bias/tfrecords/fiducial \
    --with_bary --cosmogrid_version="1.1" \
    --mode=jobarray --function=all --n_jobs=1000 --tasks="0>1000" --job_name=tfr_fidu --system=slurm

- name: grid_tfrecords
  cmd: esub msfm/apps/run_grid_preprocessing.py \
    --n_files=2500 \
    --config=configs/v8/linear_bias.yaml \
    --dir_in=/home/ipa/refreg/data/data_products/CosmoGrid/processed/CosmoGrid/v11desy3 \
    --dir_out=/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v8/linear_bias/tfrecords/grid \
    --with_bary --cosmogrid_version="1.1" \
    --mode=jobarray --function=all --n_jobs=2500 --tasks="0>2500" --job_name=tfr_grid --system=slurm

# peaks
- name: fiducial_peaks
  cmd: esub msfm/apps/run_peaks.py \
    --simset=fiducial \
    --config=configs/v8/linear_bias.yaml \
    --tfr_pattern="/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v8/linear_bias/tfrecords/fiducial/DESy3_fiducial_????.tfrecord" \
    --dir_out=/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v8/linear_bias/peaks \
    --mode=jobarray --function=all --job_name=peaks_fidu --system=slurm

- name: grid_peaks
  cmd: esub msfm/apps/run_peaks.py \
    --simset=grid \
    --config=configs/v8/linear_bias.yaml \
    --tfr_pattern="/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v8/linear_bias/tfrecords/grid/DESy3_grid_????.tfrecord" \
    --dir_out=/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v7/linear_bias/peaks \
    --mode=jobarray --function=all --job_name=peaks_grid --system=slurm
