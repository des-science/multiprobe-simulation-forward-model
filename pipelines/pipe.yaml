# datavectors
- name: fiducial_dv
  cmd: esub msfm/apps/run_datavectors.py --simset=fiducial --config=configs/v6/linear_bias.yaml --dir_in=/cluster/scratch/athomsen/CosmoGrid/fiducial --dir_out=/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v6/linear_bias/fiducial --mode=jobarray --function=all --n_jobs=1 --tasks="0" --job_name=dv_fidu --system=slurm --main_time=24

- name: perturbations_dv
  cmd: esub msfm/apps/run_datavectors.py --simset=fiducial --config=configs/v6/linear_bias.yaml --dir_in=/cluster/scratch/athomsen/CosmoGrid/fiducial --dir_out=/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v6/linear_bias/fiducial --mode=jobarray --function=all --n_jobs=12 --tasks="1>13" --job_name=dv_pert --system=slurm

- name: grid_dv
  cmd: esub msfm/apps/run_datavectors.py --simset=grid --config=configs/v6/linear_bias.yaml --dir_in=/cluster/scratch/athomsen/CosmoGrid/grid --dir_out=/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v6/linear_bias/grid --mode=jobarray --function=all --n_jobs=2500 --tasks="0>2500" --job_name=dv_grid --system=slurm

# .tfrecord
- name: fiducial_tfr
  dep: fiducial_dv
  cmd: esub msfm/apps/run_fiducial_tfrecords.py --n_files=200 --config=configs/v6/linear_bias.yaml --dir_in=/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v6/linear_bias/fiducial --dir_out=/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v6/linear_bias/tfrecords/fiducial --mode=jobarray --function=all --n_jobs=200 --tasks="0>200" --job_name=tfr_fidu --system=slurm

- name: grid_tfr
  dep: grid_dv
  cmd: esub msfm/apps/run_grid_tfrecords.py --n_files=2500 --config=configs/v6/linear_bias.yaml --dir_in=/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v6/linear_bias/grid --dir_out=/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v6/linear_bias/tfrecords/grid --mode=jobarray --function=all --n_jobs=2500 --tasks="0>2500" --job_name=tfr_grid --system=slurm

# peaks
- name: fiducial_peaks
  cmd: esub msfm/apps/run_peaks.py --simset=fiducial --config=configs/v6/linear_bias.yaml --tfr_pattern="/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v6/linear_bias/tfrecords/fiducial/DESy3_fiducial_*.tfrecord" --dir_out=/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v6/linear_bias/peaks --mode=jobarray --function=all --job_name=peaks_fidu --system=slurm

- name: grid_peaks
  cmd: esub msfm/apps/run_peaks.py --simset=grid --config=configs/v6/linear_bias.yaml --tfr_pattern="/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v6/linear_bias/tfrecords/grid/DESy3_grid_*.tfrecord" --dir_out=/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v6/linear_bias/peaks --mode=jobarray --function=all --job_name=peaks_grid --system=slurm

# power spectra NOTE that this is obsolete since the power spectra are now computed in the generation of the .tfrecords
- name: fiducial_ps
  cmd: esub msfm/apps/run_power_spectra.py --simset=fiducial --config=configs/v6/linear_bias.yaml --tfr_pattern="/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v4/large_scales/tfrecords/DESy3_fiducial_???.tfrecord" --dir_out=/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v6/linear_bias/peaks --mode=jobarray --function=all --job_name=cls_fidu --system=slurm

- name: grid_ps
  cmd: esub msfm/apps/run_power_spectra.py --simset=grid --config=configs/v6/linear_bias.yaml --tfr_pattern="/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v4/large_scales/tfrecords/DESy3_grid_???.tfrecord" --dir_out=/cluster/work/refregier/athomsen/CosmoGrid/DESY3/v6/linear_bias/peaks --mode=jobarray --function=all --job_name=cls_grid --system=slurm
